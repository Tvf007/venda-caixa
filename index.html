
<!DOCTYPE html>
<html lang="pt-BR" class="bg-amber-50 text-gray-900">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Caixa R√°pido - Padaria</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script>
    let vendaAtual = [];
    let historico = [];

    function adicionarProduto(nome, valor) {
      const existente = vendaAtual.find(item => item.nome === nome && !item.outros);
      if (existente) {
        existente.quantidade += 1;
      } else {
        vendaAtual.push({ nome, valor, quantidade: 1, outros: false });
      }
      renderNota();
    }

    function editarQuantidade(nome) {
      const item = vendaAtual.find(i => i.nome === nome && !i.outros);
      if (item) {
        const novaQtd = parseInt(prompt("Nova quantidade:", item.quantidade)) || 0;
        if (novaQtd > 0) {
          item.quantidade = novaQtd;
        } else {
          vendaAtual = vendaAtual.filter(i => i !== item);
        }
        renderNota();
      }
    }

    function removerItem(nome) {
      vendaAtual = vendaAtual.filter(i => i.nome !== nome || i.outros);
      renderNota();
    }

    function adicionarOutro() {
      const campo = document.getElementById("campo-outros");
      const valor = parseFloat(campo.value.replace(",", "."));
      if (!isNaN(valor)) {
        vendaAtual.push({ nome: "Outros", valor, quantidade: 1, outros: true });
        campo.value = "";
        renderNota();
      }
    }

    function renderNota() {
      const nota = document.getElementById("nota");
      nota.innerHTML = "";
      let total = 0;

      vendaAtual.forEach(item => {
        const li = document.createElement("li");
        const subtotal = item.valor * item.quantidade;
        total += subtotal;
        li.innerHTML = \`
          <span>\${item.nome} x\${item.quantidade} ‚Äî R$ \${subtotal.toFixed(2).replace(".", ",")}</span>
          \${!item.outros ? 
            '<button onclick="editarQuantidade(\'\${item.nome}\')" class="ml-2 text-blue-500">‚úèÔ∏è</button>' : ''}
          \${!item.outros ? 
            '<button onclick="removerItem(\'\${item.nome}\')" class="ml-1 text-red-500">üóëÔ∏è</button>' : ''}
        \`;
        nota.appendChild(li);
      });

      document.getElementById("total").textContent = total.toFixed(2).replace(".", ",");
      atualizarTroco();
    }

    function atualizarTroco() {
      const recebidoStr = document.getElementById("valor-recebido").value.replace(",", ".");
      const recebido = parseFloat(recebidoStr);
      const total = parseFloat(document.getElementById("total").textContent.replace(",", "."));
      const trocoEl = document.getElementById("troco");

      if (!isNaN(recebido) && recebido >= total) {
        const troco = recebido - total;
        trocoEl.textContent = "R$ " + troco.toFixed(2).replace(".", ",");
        trocoEl.className = "text-green-700";
      } else {
        trocoEl.textContent = "Aguardando pagamento";
        trocoEl.className = "text-gray-500";
      }
    }

    function finalizarVenda() {
      if (vendaAtual.length === 0) return;
      const data = new Date().toLocaleString();
      historico.unshift({
        id: historico.length + 1,
        data,
        itens: [...vendaAtual]
      });
      vendaAtual = [];
      document.getElementById("valor-recebido").value = "";
      document.getElementById("troco").textContent = "";
      renderNota();
      renderHistorico();
    }

    function renderHistorico() {
      const hist = document.getElementById("historico");
      hist.innerHTML = "";
      historico.forEach(venda => {
        const div = document.createElement("div");
        div.classList.add("border-b", "pb-2", "mb-2");
        div.innerHTML = \`
          <strong>Venda #\${venda.id}</strong> - \${venda.data}
          <ul class="pl-4">
            \${venda.itens.map(i => \`<li>\${i.nome} x\${i.quantidade} ‚Äî R$ \${(i.valor * i.quantidade).toFixed(2).replace(".", ",")}</li>\`).join("")}
          </ul>
        \`;
        hist.appendChild(div);
      });
    }

    function limparVenda() {
      vendaAtual = [];
      renderNota();
      document.getElementById("valor-recebido").value = "";
      document.getElementById("troco").textContent = "";
    }
  </script>
</head>
<body class="p-4 max-w-md mx-auto space-y-6">
  <h1 class="text-2xl font-bold text-center">Caixa R√°pido - Padaria</h1>
  <div class="grid grid-cols-2 gap-2">
    <button onclick="adicionarProduto('P√£o Franc√™s', 0.7)" class="bg-yellow-200 p-4 rounded shadow">P√£o Franc√™s</button>
    <button onclick="adicionarProduto('P√£o Doce', 0.7)" class="bg-yellow-300 p-4 rounded shadow">P√£o Doce</button>
    <button onclick="adicionarProduto('P√£o Doce Especial', 0.8)" class="bg-yellow-400 p-4 rounded shadow col-span-2">P√£o Doce Especial</button>
  </div>
  <div>
    <label class="block">Outros:</label>
    <input id="campo-outros" inputmode="decimal" pattern="[0-9]*" class="border p-2 w-full" onkeydown="if(event.key==='Enter') adicionarOutro()" />
    <button onclick="adicionarOutro()" class="bg-blue-200 mt-2 px-4 py-2 rounded">Adicionar</button>
  </div>
  <div>
    <h2 class="text-lg font-semibold">Nota:</h2>
    <ul id="nota" class="space-y-1 text-base"></ul>
    <div class="mt-2 bg-green-100 p-2 rounded">Total: R$ <span id="total">0,00</span></div>
  </div>
  <div>
    <label class="block">Valor Recebido:</label>
    <input id="valor-recebido" inputmode="decimal" pattern="[0-9]*" class="border p-2 w-full" oninput="atualizarTroco()" />
    <div class="mt-2">Troco: <span id="troco" class="text-gray-500">Aguardando pagamento</span></div>
  </div>
  <div class="flex gap-2">
    <button onclick="finalizarVenda()" class="bg-green-500 text-white w-full py-3 rounded shadow">Finalizar Venda</button>
    <button onclick="limparVenda()" class="bg-red-500 text-white px-4 rounded shadow">Limpar</button>
  </div>
  <div>
    <h2 class="text-lg font-semibold mt-4">Hist√≥rico de Vendas:</h2>
    <div id="historico" class="text-sm space-y-2 mt-2"></div>
  </div>
</body>
</html>
